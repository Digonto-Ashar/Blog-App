<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>My Favorites</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ng-container *ngIf="user$ | async; else guestView">
    <div *ngIf="favoritePosts$ | async as posts; else loading">
      
      <!-- NEW: Card-based list for a more modern look -->
      <div class="post-cards-container">
        <ion-card *ngFor="let post of posts" button (click)="openPost(post.id)">
          <img class="card-img" [src]="api.baseUrl.replace('/api', '') + post.featuredImage?.url" [alt]="post.title" />
          <ion-card-header>
            <ion-card-title>{{ post.title }}</ion-card-title>
            <ion-card-subtitle>{{ post.publishedAt | date:'longDate' }}</ion-card-subtitle>
          </ion-card-header>
        </ion-card>
      </div>

      <!-- Empty State -->
      <div *ngIf="posts.length === 0" class="empty-state">
        <ion-icon name="heart-outline"></ion-icon>
        <h3>No Favorites Yet</h3>
        <p>Your saved posts will appear here.</p>
      </div>
    </div>

    <!-- Loading State -->
    <ng-template #loading>
      <div class="post-cards-container">
        <ion-card *ngFor="let i of [1,2,3]">
          <ion-skeleton-text animated class="card-img-skeleton"></ion-skeleton-text>
          <ion-card-header>
            <ion-skeleton-text animated style="width: 80%; height: 24px;"></ion-skeleton-text>
            <ion-skeleton-text animated style="width: 50%; margin-top: 8px;"></ion-skeleton-text>
          </ion-card-header>
        </ion-card>
      </div>
    </ng-template>

  </ng-container>

  <!-- Guest View -->
  <ng-template #guestView>
    <div class="empty-state">
      <ion-icon name="log-in-outline"></ion-icon>
      <h3>Please Login</h3>
      <p>Log in to view your favorite posts.</p>
      <ion-button routerLink="/login" shape="round">Go to Login</ion-button>
    </div>
  </ng-template>
</ion-content>
